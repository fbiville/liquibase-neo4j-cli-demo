<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:neo4j="http://www.liquibase.org/xml/ns/dbchangelog-ext"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.4.xsd">

    <changeSet id="my-movie-init" author="fbiville">
        <comment>Creates a forgettable movie</comment>
        <neo4j:cypher>CREATE (:Movie {title: 'My Life'})</neo4j:cypher>
        <rollback>MATCH (m:Movie {title: 'My Life'}) DETACH DELETE m</rollback>
    </changeSet>

    <include file="includes/changeLog.cypher" />

    <changeSet id="show-some-neo4j-love" author="fbiville">
    	<preConditions>
            <and>
                <neo4j:version matches="4.4" />
                <neo4j:edition enterprise="true" />
                <neo4j:cypherCheck expectedResult="42">RETURN 42</neo4j:cypherCheck>
            </and>
        </preConditions>
        <neo4j:cypher>MATCH (c:Count) SET c.poweredBy = "Neo4j 4.4"</neo4j:cypher>
        <rollback>MATCH (c:Count) REMOVE c.poweredBy</rollback>
    </changeSet>

    <changeSet id="just-kidding" author="fbiville">
    	<preConditions onFail="CONTINUE">
            <!-- not the same as onError -->
            <!-- value can be HALT, CONTINUE, MARK_RAN, WARN -->
            <neo4j:version matches="1.0" />
        </preConditions>
        <neo4j:cypher>this is not gonna run</neo4j:cypher>
    </changeSet>
</databaseChangeLog>
