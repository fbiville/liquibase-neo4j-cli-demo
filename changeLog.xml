<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:neo4j="http://www.liquibase.org/xml/ns/dbchangelog-ext"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.4.xsd">

    <changeSet id="my-movie-init" author="fbiville">
        <comment>Creates a forgettable movie</comment>
        <neo4j:cypher>CREATE (:Movie {title: 'My Life'})</neo4j:cypher>
        <rollback>MATCH (m:Movie {title: 'My Life'}) DETACH DELETE m</rollback>
    </changeSet>

    <include file="includes/changeLog.cypher" />

    <changeSet id="show-some-neo4j-love" author="fbiville" runAlways="true">
    	<preConditions>
            <and>
                <sqlCheck expectedResult="true">
                    CALL dbms.components()
                    YIELD name, versions
                    WHERE name CONTAINS "Kernel"
                    RETURN versions[0] STARTS WITH "4.4"
                </sqlCheck>
            </and>
        </preConditions>
        <neo4j:cypher>MATCH (c:Count) SET c.poweredBy = "Neo4j 4.4"</neo4j:cypher>
        <rollback>MATCH (c:Count) REMOVE c.poweredBy</rollback>
    </changeSet>
</databaseChangeLog>
